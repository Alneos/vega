language: cpp

sudo: required
dist: trusty

services:
  - docker

before_install:
  - docker pull ldallolio/vegaci

script:
  - docker run -e GITHUB_TOKEN=$GITHUB_TOKEN ldallolio/vegaci /bin/sh -c "source /home/vega/.bashrc && git clone --depth=50 --branch=master https://github.com/Alneos/vega.git /home/vega/vegapp && mkdir /home/vega/vegapp/build && cd /home/vega/vegapp/build && cmake -DHDF5_LIBRARIES=$HDF_INSTALL/lib/libhdf5.a -DHDF5_INCLUDE_DIRS=$HDF_INSTALL/include -DMEDFILE_C_LIBRARIES=$MED_INSTALL/lib/libmedC.a -DMEDFILE_INCLUDE_DIRS=$MED_INSTALL/include -DCMAKE_BUILD_TYPE=Debug -DRUN_SYSTUS=OFF .. && make -j2 && ctest -D Experimental ."

